{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.1", "generated_at": "2023-11-09T20:59:10.245570Z", "invocation_id": "e198ec98-6587-45c4-b0d2-709ff442262c", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-09T20:59:09.902368Z", "completed_at": "2023-11-09T20:59:09.915859Z"}, {"name": "execute", "started_at": "2023-11-09T20:59:09.936868Z", "completed_at": "2023-11-09T20:59:10.097906Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.21477890014648438, "adapter_response": {"_message": "SELECT 209", "code": "SELECT", "rows_affected": 209}, "message": "SELECT 209", "failures": null, "unique_id": "model.tattoos_ELT.dim_location", "compiled": true, "compiled_code": "SELECT \n    md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lugar as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as location_id,\n    lugar\nFROM\n    tattoo_raw_data", "relation_name": "\"tattoo_raw_data\".\"public\".\"dim_location\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-09T20:59:09.893588Z", "completed_at": "2023-11-09T20:59:09.914930Z"}, {"name": "execute", "started_at": "2023-11-09T20:59:09.918984Z", "completed_at": "2023-11-09T20:59:10.101137Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.21780848503112793, "adapter_response": {"_message": "SELECT 209", "code": "SELECT", "rows_affected": 209}, "message": "SELECT 209", "failures": null, "unique_id": "model.tattoos_ELT.dim_client", "compiled": true, "compiled_code": "SELECT \n    md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(nombre as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as client_id,\n    nombre \nFROM\n    tattoo_raw_data", "relation_name": "\"tattoo_raw_data\".\"public\".\"dim_client\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-09T20:59:09.906775Z", "completed_at": "2023-11-09T20:59:09.916412Z"}, {"name": "execute", "started_at": "2023-11-09T20:59:09.971751Z", "completed_at": "2023-11-09T20:59:10.099538Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.21463823318481445, "adapter_response": {"_message": "SELECT 209", "code": "SELECT", "rows_affected": 209}, "message": "SELECT 209", "failures": null, "unique_id": "model.tattoos_ELT.dim_tattoo", "compiled": true, "compiled_code": "SELECT \n    md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(nombre as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tatuaje as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as tattoo_id,\n    tatuaje,\n    estilo,\n    zona,\n    tiempo,\n    \"necesita repaso?\" AS necesita_repaso,\n    \"repaso hecho?\" AS repaso_hecho,\n    dise\u00f1o,\n    pagado\nFROM\n    tattoo_raw_data", "relation_name": "\"tattoo_raw_data\".\"public\".\"dim_tattoo\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-09T20:59:10.125513Z", "completed_at": "2023-11-09T20:59:10.144343Z"}, {"name": "execute", "started_at": "2023-11-09T20:59:10.146112Z", "completed_at": "2023-11-09T20:59:10.209164Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09427952766418457, "adapter_response": {"_message": "SELECT 209", "code": "SELECT", "rows_affected": 209}, "message": "SELECT 209", "failures": null, "unique_id": "model.tattoos_ELT.fact_tattoo", "compiled": true, "compiled_code": "WITH fct_tattoo_cte AS (\n    SELECT\n        md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(nombre as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tatuaje as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lugar as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(fecha as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as fact_id,\n        md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(nombre as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as client_id,\n        md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lugar as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as location_id,\n        md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(nombre as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tatuaje as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as tattoo_id,\n        md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(nombre as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tatuaje as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(fecha as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as time_id,\n        precio\n    FROM tattoo_raw_data\n)\n\nSELECT\n    -- Assuming the existence of suitable fields in your source data for appointment_id, cantidad_tatuajes, and monto_pago\n    fact_id,\n    dc.client_id,\n    dt.tattoo_id,\n    dl.location_id,\n    dtime.time_id,\n    CAST(REPLACE(SUBSTRING(precio FROM 2), '.', '') AS INTEGER) AS precio\nFROM\n    fct_tattoo_cte AS ft\nJOIN\n    dim_client dc ON ft.client_id = dc.client_id\nJOIN\n    dim_location dl ON ft.location_id = dl.location_id\nJOIN\n    dim_tattoo dt ON ft.tattoo_id = dt.tattoo_id\nJOIN\n    dim_time dtime ON ft.time_id = dtime.time_id", "relation_name": "\"tattoo_raw_data\".\"public\".\"fact_tattoo\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-09T20:59:10.118845Z", "completed_at": "2023-11-09T20:59:10.137172Z"}, {"name": "execute", "started_at": "2023-11-09T20:59:10.139583Z", "completed_at": "2023-11-09T20:59:10.225018Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.11142301559448242, "adapter_response": {"_message": "SELECT 209", "code": "SELECT", "rows_affected": 209}, "message": "SELECT 209", "failures": null, "unique_id": "model.tattoos_ELT.dim_time", "compiled": true, "compiled_code": "SELECT \n    md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(nombre as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tatuaje as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(fecha as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as time_id,\n    TO_DATE(fecha, 'DD-MM-YYYY') as fecha_tattoo,\n    TO_DATE(\"fecha pago\", 'DD-MM-YYYY') AS fecha_pago,\n    TO_CHAR(TO_DATE(fecha, 'DD-MM-YYYY'), 'MM')::INTEGER as mes_tattoo,\n    TO_CHAR(TO_DATE(fecha, 'DD-MM-YYYY'), 'YYYY') as a\u00f1o_tattoo,\n    TO_CHAR(TO_DATE(\"fecha pago\", 'DD-MM-YYYY'), 'MM')::INTEGER as mes_pago,\n    TO_CHAR(TO_DATE(\"fecha pago\", 'DD-MM-YYYY'), 'YYYY') as a\u00f1o_pago\nFROM\n    tattoo_raw_data", "relation_name": "\"tattoo_raw_data\".\"public\".\"dim_time\""}], "elapsed_time": 0.456681489944458, "args": {"static_parser": true, "defer": false, "invocation_command": "dbt run --profiles-dir /usr/local/airflow/include/dbt/", "macro_debugging": false, "project_dir": "/usr/local/airflow/include/dbt", "cache_selected_only": false, "print": true, "select": [], "log_level": "info", "partial_parse": true, "log_format": "default", "version_check": true, "write_json": true, "vars": {}, "favor_state": false, "populate_cache": true, "printer_width": 80, "log_level_file": "debug", "introspect": true, "strict_mode": false, "indirect_selection": "eager", "log_format_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "use_colors_file": true, "quiet": false, "enable_legacy_logger": false, "log_file_max_bytes": 10485760, "profiles_dir": "/usr/local/airflow/include/dbt/", "use_colors": true, "which": "run", "partial_parse_file_diff": true, "exclude": [], "send_anonymous_usage_stats": true, "show_resource_report": false, "log_path": "/usr/local/airflow/include/dbt/logs"}}